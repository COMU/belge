<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-9"><meta name="date" content="2008-10-06T09:28:18+03:00"><title>PPPD</title><link rel="icon" type="image/png" href="../images/belgeler-logo.png"><link rel="stylesheet" href="../belgeler.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V-special(derived from 1.49 for Turkish Linux Documentation WG by Nilgün Belma Bugüner - nilgun@superonline.com)"><link rel="home" href="../KiTAPLIK/index.html" title="Linux Kitaplýðý"><link rel="up" href="../howto/leased-line-howto.html" title="Kiralýk Hat-Mini NASIL"><link rel="previous" href="../howto/leased-line-howto-modem.html" title="Modem"><link rel="next" href="../howto/howtos-apps.html" title="V. Oylum - Uygulamalar/Masaüstü/Çoklu Ortam"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><table width="100%" summary="Navigation header" cellpadding="1" cellspacing="0" border="0"><tr><td bgcolor="black" class="navoutline"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td bgcolor="white" class="navinline"><table width="100%" cellpadding="3" cellspacing="0" border="0"><tr><th colspan="3" align="center">PPPD</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="../howto/leased-line-howto-modem.html">Önceki</a> </td><th width="60%" align="center">Kiralýk Hat-Mini NASIL</th><td width="20%" align="right"> <a accesskey="n" href="../howto/howtos-apps.html">Sonraki</a></td></tr></table></td></tr></table></td></tr></table><dl><div class="sect1"><dt><div> <h2 class="title" style="clear: both"><a name="leased-line-howto-pppd"></a>PPPD</h2></div></dt><dd><p>
Bir pppd'ye (Point to Point Protocol Deamon) ve nasýl çalýþtýðýna dair makul bir bilgiye sahip olmalýsýnýz. 
Eðer gerekliyse ilgili RFC'lere ya da <a href="http://www.tldp.org/HOWTO/PPP-HOWTO/index.html" target="_top">
Linux PPP NASIL</a> belgesine göz atabilirsiniz. 
Eðer bir login prosedürü kullanmayacaksanýz, (m)getty kullanmanýza ya da baðlantýnýzý kontrol eden
 pppd ile iliþkilendirilmiþ (sahte) bir kullanýcýya ihtiyacýnýz olmayacak.
Eðer telefon etmeyecekseniz, herhangi bir konuþma betiðine de gerek kalmaz.  
Aslýnda kurduðunuz modem devreleri ve yapýlandýrmasý biraz da tamamen telli boþ modem kablolarýna benzer. 
 Bu da pppd'nizi boþ bir modem kablosunu nasýl yapacaksanýz ayný yolla yapýlandýrmanýz gerektiði anlamýna gelir. 
</p><p>
Güvenilir bir baðlantý için, kurulumunuz aþaðýdaki kriterleri izlemelidir;
</p><p><div class="itemizedlist"><ul type="disc"><li>
Sisteminizin ön yüklemesinden kýsa bir süre sonra pppd, RS232 portunuzda DTR sinyalini vermeli, DCD'nin çýkmasýný 
beklemeli ve  baðlantýyý müzakere etmelidir.
</li><li>
Eðer uzak sisteme eriþilemiyorsa, pppd tekrar eriþilene kadar beklemede kalmalýdýr.
</li><li>
Eðer baðlantý geldiyse ve devam ediyorsa, pppd modemi yeniden ayarlamalý 
(bu iþlem DTR'yi düþürüp sonra da yükseltilerek yapýlýr), ve daha sonra yeniden baðlantý kurmaya çalýþmalýdýr. 
</li><li>
Eðer baðlantýnýn kalitesi çok düþükse, pppd modemi yeniden ayarlamalý ve baðþantýyý yeniden kurmalýdýr.
</li><li>
Eðer baðlantýyý kontrol eden süreç, yeni pppd ölürse bir bekçiköpeði (watchdog) pppd'yi yeniden baþlatmalýdýr. 
</li></ul></div></p><dl><div class="sect2"><dt><div> <h3 class="title"><a name="leased-line-howto-pppd-conf"></a>Yapýlandýrma</h3></div></dt><dd><p>
Örneðin modemin COM2'ye baðlý olduðunu, yerel IP adresinin `Loc_Ip' olduðunu ve 
uzak IP adresinin `Rem_Ip' olduðunu düþünelim. 
MTU için 576'yý kullanmak istiyoruz. <tt>/etc/ppp/options.ttyS1</tt> dosyamýz aþaðýdaki 
gibi olmalýdýr:
</p><p>
<div class="screen" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="screen">
crtscts
mru 576
mtu 576
passive
Loc_Ip:Rem_Ip
-chap
modem
#noauth
-pap
persist
#maxfail 0
#holdoff 10
</pre> </td></tr></table></div>
</p><p>
'asyncmap 0','lock', 'modem' ve '-detach' gibi þeyler muhtemelen <tt>/etc/ppp/options</tt> 
dosyasýnda bulunuyordur. Eðer öyle deðilse, bunlarý <tt>/etc/ppp/options.ttyS1</tt> dosyanýza 
eklemelisiniz.
Eðer yerel sisteminiz 192.168.1.1 ve uzak sisteminiz 10.1.1.1 ise, yerel sisteminizdeki 
<tt>/etc/ppp/options.ttyS1</tt> dosyanýz aþaðýdaki gibi olmalýdýr:
</p><p>
<div class="screen" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="screen">
crtscts
mru 576
mtu 576
passive
192.168.1.1:10.1.1.1
-chap
modem
#noauth
-pap
persist
#maxfail 0
#holdoff 10
</pre> </td></tr></table></div>
</p><p>
Uzak sistemdeki ttyS1 seçenekleri þöyle olmalýdýr:
</p><p>
<div class="screen" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="screen">
crtscts
mru 576
mtu 576
passive
10.1.1.1:192.168.1.1
-chap
modem
#noauth
-pap
persist
#maxfail 0
#holdoff 10
</pre> </td></tr></table></div>
</p><p>
'passive' seçeneði baðlantý (ya da yeniden baðlantý) giriþimlerinin sayýsýný sýnýrlar. 
'persist' seçeneði pppd'nin ilk seferde baðlantý kuramadýðý takdirde ya da baðlantý koptuðunda ayakta olmasýný 
saðlar. 
Eðer dosya transferleri sýrasýnda (FTP ya da internette gezinirken) çok fazla telnet kullanýrsanýz 
296 gibi daha küçük bir MTU ve MRU kullanmanýz daha iyi olacaktýr. 
Böylece uzak sisteminizi daha unumlu hale getirmiþ olacaksýnýz.

Eðer FTP kullanýrken telnet'i fazla umursamazsanýz o zaman MTU ve MRU'yu 1500 gibi büyük bir deðer yapabilirsiniz.

 Ayný zamanda UDP'nin parçalanamayacaðýný da aklýnýzda bulundurun. 
 Örneðin UDP paketlerinin 512 bayt olduðunu kabul edelim. O halde asgari MTU'nun 552 bayt olmasý gerekecektir. 
 
'noauth' seçeneði bazý yeni daðýtýmlar için gerekli olabilir. 

`maxfail 0'  de daha yeni PPPD'ler için gerekli olabilir. 

Baðlantý kaybolduktan sonra PPPD yeniden baðlanmak için bir süre bekleyecektir.
Bekleme süresi 'holdoff' seçeneði ile ayarlanabilir. 
Varsayýlan holdoff 30 saniye olarak kullanýlýrdý ancak artýk sýfýr kullanýlýyor. holdoff seçeneði genelde 
10 olarak kullanýlýr.
</p></dd></div></dl><dl><div class="sect2"><dt><div> <h3 class="title"><a name="leased-line-howto-scripts"></a>Betikler</h3></div></dt><dd><dl><div class="sect3"><dt><div> <h4 class="title"><a name="leased-line-howto-start"></a>  pppd'yi baþlatma ve ayakta tutma</h4></div></dt><dd><p>

pppd formunu bir önyükleme betiðinden (rc) çalýþtýrabilirsiniz. Buna raðmen eðer bu yolu kullanýrsanýz ve pppd 
ölürse, o zaman bir baðlantýnýz da olmayacaktýr. Daha kararlý bir çözüm, pppd'yi <tt>/etc/inittab</tt>'dan baþlatmak 
olacaktýr;
</p><p>
<div class="screen" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="screen">
s1:23:respawn:/usr/sbin/pppd /dev/ttyS1 115200
</pre> </td></tr></table></div>
</p><p>

Bu yöntem sayesinde pppd ölürse, yeniden baþlatýlacaktýr. 


Ancak `-detach' seçeneðiniz olduðundan (yeni sistemlerde 'nodetach') emin olun, 

aksi takdirde inittab pppd'nin bir çok örneðini baþlatacaktýr. 

</p><p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0"><tr><td rowspan="2" align="center" valign="top" width="25"><img src="../images/xsl/note.png"></td><th>Not</th></tr><tr><td colspan="2" align="left" valign="top"><p>
Bazý eski sistemler `115200' hýzýný kabul etmeyecektir.  
Bu durumda hýzý 38400 yapmanýz ve setseral ile `spd_vhi' bayraðýný ayarlamanýz gerekecektir. Bazý sistemler `ttyS' aygýtý yerine `cua' kullandýðýnýzý varsayarlar. 
</p></td></tr></table></div></p></dd></div></dl><dl><div class="sect3"><dt><div> <h4 class="title"><a name="leased-line-howto-routes"></a>Rotalarýn Kurulumu</h4></div></dt><dd><p>
Varsayýlan rota 'defaultroute' seçeneði ile ya da 
<tt>/etc/ppp/ip-up</tt> betiðiyle ayarlanabilir; 

</p><p>
<div class="screen" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="screen">
#!/bin/bash
case $2 in
     /dev/ttyS1)
          /sbin/route add -net 0.0.0.0 gw Rem_Ip netmask 0.0.0.0
          ;;
esac
</pre> </td></tr></table></div>
</p><p>
Ip-up ayný zamanda sistem saatinizi netdate kullanarak 
eþzamanlamak için kullanýlabilir.
</p><p>

Rotanýn ip-up içide varsayýlan rota olarak ayarlanmasý zorunlu deðildir. 
Sizin ip-up'ýnýz uzak aðdaki rotayý ayarlarlarken, uzak sistemdeki ip-up betiði de 
sizin aðýnýza eriþmek için gereken rotayý ayarlar.

Eðer aðýnýz 192.168.1.0 ve ppp arayüzünüz 192.168.1.1 ise, uzak sistemdeki ip-up betiði aþaðýdaki gibi olmalýdýr;

</p><p>
<div class="screen" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="screen">
#!/bin/bash
case $2 in
   /dev/ttyS1)
      /sbin/route add -net 192.168.1.0 gw 192.168.1.1 netmask 255.255.255.0
      ;;
esac
</pre> </td></tr></table></div>
</p><p>


`case $2' ve `/dev/ttyS1)' bitleri birden fazla ppp baðlantýnýz olduðu durumlarda iþinize yarar. 
Ip-up baðlantý kurulduðu her sefer çalýþacaktýr, ama sadece `/dev/ttySx)' ve 
 `;;' arasýndakiler iþletilecektir ve doðru ttyS için rota belirlenecektir.
 Rotalama hakkýnda daha fazla bilgiyi <a href="http://www.tldp.org/HOWTO/HOWTO-INDEX/networking.html" target="_top">Linux Að Oluþturma NASIL</a> belgesinde bulabilirsiniz. 
</p><p>
Bazý sistemler temel bir tty üzerinden rota edemekdikleri zaman dinamik ttys kullanmayý tercih ederler. 

Bu durumda ip adresini bir ppp arayüzüne çevirmek ve sonra da belli bir ppp arayüzünden rotalama (ve güvenlik duvarý) yapmak 
daha elveriþli olabilir. 
Bu yüzden <tt>/etc/ppp/ip-up</tt> dosyasýný aþaðýdaki gibi düzenledim;
</p><p>
<div class="screen" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="screen"># Bu deðiþkenler çalýþan-kýsýmlar tarafýndan betiklerin çalýþtýrýlmasý içindir
PPP_IFACE="$1"
PPP_TTY="$2"
PPP_SPEED="$3"
PPP_LOCAL="$4"
PPP_REMOTE="$5"
PPP_IPPARAM="$6"
export PPP_IFACE PPP_TTY PPP_SPEED PPP_LOCAL PPP_REMOTE PPP_IPPARAM

# ip ' yi  ppp ' ye çevirme
echo $PPP_IFACE &gt; "/var/run/ppp/if-$PPP_LOCAL"
sleep 1
# Güvenlik duvarýný tekrar çalýþtýrma .
/usr/local/sbin/rc.block

# (Varsayýlan) rotaya (ya da rotalara ) dikkat edilmesi
case $PPP_LOCAL in
        "My_Ip_Address")
                /sbin/route add -net 0.0.0.0 gw $PPP_REMOTE netmask 0.0.0.0
                ;;

esac

# Önyüklemede sabit þeyler atlandý
if ! ( netstat -an | grep 'My_Ip_Address:53' &gt; /dev/null 2&gt;&amp;1 )
then
        # Just booted
        # Sync clock
        /usr/local/sbin/ntpdate.sh &amp;
        # Set the null routes
        /usr/local/sbin/null-route.sh &amp;
        # Bind 9 needs this;
        sleep 1
        /etc/init.d/bind9 restart
fi

# Bir sesli uyarý ihbarý
/bin/echo -ne "\007" &gt;&gt; /dev/tty1</pre> </td></tr></table></div>
</p><p>'My_Ip_Address' kýsmýný kendi Ip adresinizle deðiþtirin.<tt>/usr/local/sbin/ntpdate.sh</tt> dosyasý saati eþzamanlamak için kullanýlýr. Bu dosya NTPD'yi durdurur, ntpdate kullanarak eþzamanlamayý yapar ve NTPD'yi yeniden baþlatýr. <tt>/usr/local/sbin/null-route.sh</tt> boþ rotalarý ayarlayan bir dosyadýr;</p><p><div class="screen" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="screen">#!/bin/bash
# RFC 1918
route add -net 10.0.0.0    netmask 255.0.0.0   reject
route add -net 172.16.0.0  netmask 255.240.0.0 reject
route add -net 192.168.0.0 netmask 255.255.0.0 reject
# RFC 3927
route add -net 169.254.0.0 netmask 255.255.0.0 reject</pre> </td></tr></table></div>
</p><p>Eðer kullanýmda RFC 1918 adreslerine sahipseniz, boþ rotalar daha küçük bir að maskesi kullanmanýza izin vermeyeceklerdir. 192.168.1.0/24 aðý boþ rota 192.168.0.0/16 tarafýndan rahatsýz edilmeyecektir;</p><p><div class="screen" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="screen">Kernel IP rota tespit etme tablosu
Hedef    Að Geçidi         Bilgi Maskesi         Bayrak Metrik Ref    Use Iface
255.255.255.255 0.0.0.0         255.255.255.255 UH    0      0        0 eth0
195.190.249.4   0.0.0.0         255.255.255.255 UH    0      0        0 ppp0
10.0.0.0        0.0.0.0         255.255.255.0   U     0      0        0 eth1
192.168.1.0     0.0.0.0         255.255.255.0   U     0      0        0 eth0
169.254.0.0     -               255.255.0.0     !     0      -        0 -
192.168.0.0     -               255.255.0.0     !     0      -        0 -
172.16.0.0      -               255.240.0.0     !     0      -        0 -
10.0.0.0        -               255.0.0.0       !     0      -        0 -
0.0.0.0         195.190.249.4   0.0.0.0         UG    0      0        0 ppp0</pre> </td></tr></table></div>
</p></dd></div></dl></dd></div></dl><dl><div class="sect2"><dt><div> <h3 class="title"><a name="leased-line-howto-pppd-test"></a>Test</h3></div></dt><dd><p>Her þeyi test etmek modemi test etmek gibidir. Eðer çalýþýrsa, bisikletinize atlayýn ve uzak modemi baðlantýnýzýn uzak tarafýna taþýyýn. Eðer çalýþmazsa, o zaman yapmanýz gereken ilk iþlerden biri COM portunun hýzýný kontrol etmek olacaktýr; genelde sýkça yapýlan hatalardan biri Minicom'lu modemleri tek bir hýz  kullanarak yapýlandýrmak ve daha sonra da baþka bir tane hýz kullanarak pppd'yi ayarlamaktýr. Bu hiç bir zaman <b>çalýþmayacaktýr! </b> Her zaman ayný hýzý kullanmak zorundasýnýz!</p></dd></div></dl></dd></div></dl><h1></h1><table width="100%" summary="Navigation header" cellpadding="1" cellspacing="0" border="0"><tr><td bgcolor="black" class="navoutline"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td bgcolor="white" class="navinline"><table width="100%" cellpadding="3" cellspacing="0" border="0"><tr><td width="40%" align="left"><a accesskey="p" href="../howto/leased-line-howto-modem.html">Önceki</a> </td><td width="20%" align="center"><a accesskey="u" href="../howto/leased-line-howto.html">Üst Ana Baþlýk</a></td><td width="40%" align="right"> <a accesskey="n" href="../howto/howtos-apps.html">Sonraki</a></td></tr><tr><td width="40%" align="left" valign="top">Modem </td><td width="20%" align="center"><a accesskey="h" href="../KiTAPLIK/index.html">Baþlangýç</a></td><td width="40%" align="right" valign="top"> V. Oylum - Uygulamalar/Masaüstü/Çoklu Ortam</td></tr><tr><td colspan="3" align="center">
                  Bir <a href="http://www.belgeler.org/">Linux Kitaplýðý</a> Sayfasý
                </td></tr></table></td></tr></table></td></tr></table></body></html>
