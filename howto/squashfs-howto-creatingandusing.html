<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-9"><meta name="date" content="2008-09-24T01:03:45+03:00"><title>Sýkýþtýrýlmýþ Dosya Sistemini Oluþturmak ve Kullanmak</title><link rel="icon" type="image/png" href="../images/belgeler-logo.png"><link rel="stylesheet" href="../belgeler.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V-special(derived from 1.49 for Turkish Linux Documentation WG by Nilgün Belma Bugüner - nilgun@superonline.com)"><link rel="home" href="../KiTAPLIK/index.html" title="Linux Kitaplýðý"><link rel="up" href="../howto/squashfs-howto.html" title="SquashFS NASIL"><link rel="previous" href="../howto/squashfs-howto-tools.html" title="SquashFS Araçlarý"><link rel="next" href="../howto/squashfs-howto-acknowledgements.html" title="Teþekkür"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><table width="100%" summary="Navigation header" cellpadding="1" cellspacing="0" border="0"><tr><td bgcolor="black" class="navoutline"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td bgcolor="white" class="navinline"><table width="100%" cellpadding="3" cellspacing="0" border="0"><tr><th colspan="3" align="center">Sýkýþtýrýlmýþ Dosya Sistemini Oluþturmak ve Kullanmak</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="../howto/squashfs-howto-tools.html">Önceki</a> </td><th width="60%" align="center">SquashFS NASIL</th><td width="20%" align="right"> <a accesskey="n" href="../howto/squashfs-howto-acknowledgements.html">Sonraki</a></td></tr></table></td></tr></table></td></tr></table><dl><div class="sect1"><dt><div> <h2 class="title" style="clear: both"><a name="squashfs-howto-creatingandusing"></a>Sýkýþtýrýlmýþ Dosya Sistemini Oluþturmak ve Kullanmak</h2></div></dt><dd><dl><div class="sect2"><dt><div> <h3 class="title"><a name="squashfs-howto-creatingandusing-basic"></a>Temel Adýmlar</h3></div></dt><dd><p>Tek bir dizin (örneðin <tt>/some/dir</tt>) kullanarak sýradan bir dosyada (dosya sistemi görüntüsü) çýktýsý oluþacak bir sýkýþtýrýlmýþ dosya sistemi oluþturmak için aþaðýdaki komutu kullanmak yeterlidir.<div class="screen" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="screen">bash# mksquashfs /some/dir dir.sqsh</pre> </td></tr></table></div></p><p>Bu komutun sonucu olarak <b><tt>mksquashfs</tt></b> sýkýþtýrma iþlemini yapacak ve düðüm sayýsýný, yazýlan veri boyutunu ve ortalama sýkýþtýrma oranýný çýktý olarak verecektir. Böylece <tt>/some/dir</tt> dizininin görüntüsünü <tt>dir.sqsh</tt> dosyasýna almýþ olduk. <b><tt>mount</tt></b> komutunu kullanarak bu dosyayý baðlayabilirsiniz.<div class="screen" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="screen">bash# mkdir /mnt/dir
bash# mount dir.sqsh /mnt/dir -t squashfs -o loop</pre> </td></tr></table></div></p><p>Her þeyin yolunda olup olmadýðýný kontrol edelim.<div class="screen" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="screen">bash# ls /mnt/dir</pre> </td></tr></table></div></p><p>Eðer çýktýyý doðrudan bir aygýta (örneðin <tt>/dev/fd0</tt>'daki disketinize) almak isterseniz:<div class="screen" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="screen">bash# mksquashfs /some/dir /dev/fd0</pre> </td></tr></table></div></p><p>Bu aygýtý <b><tt>mount</tt></b> ile baðlayalým;<div class="screen" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="screen">bash# mount /dev/fd0 /mnt/floppy -t squashfs</pre> </td></tr></table></div></p><p>Her þeyin yerli yerinde olup olmadýðýný kontrol edelim;<div class="screen" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="screen">bash# ls /mnt/floppy</pre> </td></tr></table></div></p></dd></div></dl><dl><div class="sect2"><dt><div> <h3 class="title"><a name="squashfs-howto-creatingandusing-squashing"></a>Dosya Sistemini Sýkýþtýrmak</h3></div></dt><dd><p>Burada anlatýlan iþlemler salt okunur sýkýþtýrýlmýþ dosya sisteminin kullanýlabileceði çoðu duruma uygundur. Bu durumlar sýklýkla deðiþmeyen büyük FTP/HTTP arþivleri, sýkýþtýrýlmýþ <tt>/usr</tt> dizinleri veya baþka bir þey olabilir.</p><dl><div class="sect3"><dt><div> <h4 class="title"><a name="squashfs-howto-creatingandusing-squashing-1"></a>Örnek 1</h4></div></dt><dd><p>Ýçerisinde bir çok dosyanýn bulunduðu bir <tt>/var/arch</tt> dizininizin olduðunu ve bu dizini sýkýþtýrýlmýþ dosya sistemine dönüþtürerek kök dizininde bir dosya (baðlayýp kullanabileceðiniz bir dosya sistemi görüntüsü de olabilir) olarak tutmak istediðinizi düþünelim. Bunun için aþaðýdaki adýmlarý izlemeniz gerekir:</p><p>Dizini sýkýþtýrýn, loopback aygýtý üzerinden denemek için baðlayýn:<div class="screen" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="screen">bash# mksquashfs /var/arch /var/arch.sqsh
bash# mkdir /mnt/tmp
bash# mount /var/arch.sqsh /mnt/tmp -t squashfs -o loop
bash# ls /mnt/tmp</pre> </td></tr></table></div></p><p>Herþey beklediðiniz gibi giderse her açýlýþta otomatik baðlanmasý için <tt>/etc/fstab</tt> dosyasýna aþaðýdaki satýrý ekleyin:<div class="screen" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="screen">/var/arch.sqsh	/var/arch	squashfs	ro,defaults	0 0</pre> </td></tr></table></div></p><p>Geçici baðlanma noktasýndan çözüp fstab girdisine uygun yeniden baðlayýn:<div class="screen" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="screen">bash# umount /mnt/tmp
bash# mount /var/arch</pre> </td></tr></table></div></p><p>Son olarak her þeyin yolunda olduðunu kontrol edin:<div class="screen" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="screen">bash# ls /var/arch</pre> </td></tr></table></div></p></dd></div></dl><dl><div class="sect3"><dt><div> <h4 class="title"><a name="squashfs-howto-creatingandusing-squashing-2"></a>Örnek 2</h4></div></dt><dd><p>Bu örnekte iki disk bölümünüz olsun: <tt>/dev/hda6</tt> (boþ) ve <tt>/dev/hda7</tt> (veri ile dolu, <tt>/var/arch</tt> dizinine baðlý ve <tt>/dev/hda6</tt>'dan daha büyük). Ýstediðiniz þey de <tt>/dev/hda7</tt>'yi sýkýþtýrýp <tt>/dev/hda6</tt>'ya taþýmak ve <tt>/dev/hda7</tt>'yi baþka amaçlar için kullanmak olsun. <tt>/etc/fstab</tt> dosyasýnda aþaðýdaki gibi bir satýr olduðunu kabul edeceðiz (reiserfs örnek olarak kullanýlmýþtýr):<div class="screen" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="screen">/dev/hda7	/var/arch	reiserfs	defaults	0 0</pre> </td></tr></table></div></p><p>Bir önceki örnektekine benzer þeyler yapalým:<div class="screen" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="screen">bash# mksquashfs /var/arch /var/arch.sqsh
bash# mkdir /mnt/tmp
bash# mount /var/arch.sqsh /mnt/tmp -t squashfs -o loop
bash# ls /mnt/tmp</pre> </td></tr></table></div></p><p>Her þey yolunda gitmiþse <tt>/dev/hda7</tt>'yi çözün ve <b><tt>dd</tt></b> komutunu kullanarak <tt>/var/arch.sqsh</tt> dosyasýný <tt>/dev/hda6</tt> olarak kopyalayýn:<div class="screen" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="screen">bash# umount /dev/hda7
bash# dd if=/var/arch.sqsh of=/dev/hda6</pre> </td></tr></table></div></p><p>Artýk <tt>/etc/fstab</tt> dosyasýnda <tt>/dev/hda7</tt> için bulunan satýrý aþaðýdaki gibi deðiþtirebilirsiniz:<div class="screen" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="screen">/dev/hda6	/var/arch	squashfs	ro,defaults	0 0</pre> </td></tr></table></div></p><p>Yeni dosya sistemini baðlayýp kontrol edin:<div class="screen" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="screen">bash# mount /var/arch
bash# ls /var/arch</pre> </td></tr></table></div></p><p>Artýk ihtiyacýnýz olmayan sistem görüntüsünü silmeyi unutmayýn:<div class="screen" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="screen">bash# rm /var/arch.sqsh</pre> </td></tr></table></div></p></dd></div></dl></dd></div></dl><dl><div class="sect2"><dt><div> <h3 class="title"><a name="squashfs-howto-creatingandusing-creating"></a>Küçük/Gömülü Sistem Yaratmak</h3></div></dt><dd><p>"Küçük/Gömülü" terimi ile floppy diskler, IDE/USB flash diskler, iso9660 CD-ROM'lar, küçük boyutlu sabit diskler ve benzerleri ile açýlmasý için imal edilmiþ Linux sistemleri kastediyorum. Ýster bütün kök dizinini tek aygýt üzerinde (tek disk bölümü veya tek disket) tutun, isterseniz modüler (birden çok disket ya da disk bölümü) bir yapýnýz olsun izlenecek yol aynýdýr. Böyle Linux sistemlerini yaratmak bu belgenin kapsamýnýn dýþýndadýr. <a href="http://www.tldp.org" target="_top">http://www.tldp.org</a> adresinde bu konuyla ilgili NASIL belgelerine ve kýlavuzlara ulaþabilirsiniz. </p><dl><div class="sect3"><dt><div> <h4 class="title"><a name="squashfs-howto-creatingandusing-creating-disk"></a>Disket/Flash/Sabit Disk üzerinde Sýkýþtýrýlmýþ Dosya Sistemi</h4></div></dt><dd><p>Küçük diskler üzerinde Linux sistemler yaratýrken SquashFS kullanmak için minimal sistemler yaratýrken izlenen adýmlar izlenmelidir.</p><p><div class="itemizedlist"><ul type="disc"><li>Sisteminizin sýkýþtýrýlmýþ dosya sistemlerini baðlayabilmesi için derlediðiniz çekirdekte SquashFS desteðini aktif edin.</li><li>Salt okunur ram diskleri ve/veya kök ve/veya diðer diskleri oluþturmak için <b><tt>mksquashfs</tt></b> komutunu kullanýn.</li><li>Sýkýþtýrýlmýþ dosya sistemlerini baðlayabilmek için <tt>/etc/fstab</tt> dosyasýnda ve baþlangýç betiklerinde dosya sistemi olarak squashfs'i belirtin.</li></ul></div></p><div class="sect4"><div> <h5 class="title"><a name="squashfs-howto-creatingandusing-creating-disk-floppy"></a>Örnek Disket</h5></div><p>Disket sistem aðacýnýz <tt>/home/user/floppylinux</tt> dizininde bulunsun ve sizin kök dosya sistemini bir diskette, <tt>/usr</tt> dizinini bir diðerinde bulundurmak istediðinizi farzedelim. Bunun için þunlarý yapmalýsýnýz:<div class="screen" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="screen">bash# cd /home/user
bash# mksquashfs floppylinux root.sqsh -e usr
bash# mksquashfs floppylinux/usr usr.sqsh</pre> </td></tr></table></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0"><tr><td rowspan="2" align="center" valign="top" width="25"><img src="../images/xsl/note.png"></td><th>Not</th></tr><tr><td colspan="2" align="left" valign="top"><p>Gördüðünüz gibi <b><tt>-e</tt></b> seçeneðini kullanarak <tt>/usr</tt> dizinini kök dosya sistemi görüntüsüne dahil etmedik.</p></td></tr></table></div>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0"><tr><td rowspan="2" align="center" valign="top" width="25"><img src="../images/xsl/note.png"></td><th>Not</th></tr><tr><td colspan="2" align="left" valign="top"><p>Kök dizininizin <tt>/etc/fstab</tt> dosyasýnda veya baþlangýç betiklerinde <tt>/usr</tt> dizininin tipini squashfs olarak belirtmeyi unutmayýn.</p></td></tr></table></div></p><p>Disket sürücünüze bir disket yerleþtirin (bu disket üzerinde bir dosya sistemi olduðunu, lilo veya grub bulunduðunu ve kök dosya sisteminin <tt>/boot</tt> altýnda olacaðýný kabul ediyorum):<div class="screen" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="screen">bash# mount /mnt/floppy
bash# cp root.sqsh /mnt/floppy/boot</pre> </td></tr></table></div></p><p>Ýþlem bittiðinde kök disketini çözün, <tt>/usr</tt> için yeni bir disket takýn ve usr dosya sisteminitaþýmak için <b><tt>dd</tt></b>'yi kullanýn:<div class="screen" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="screen">bash# dd if=usr.sqsh of=/dev/fd0</pre> </td></tr></table></div></p></div></dd></div></dl><dl><div class="sect3"><dt><div> <h4 class="title"><a name="squashfs-howto-creatingandusing-creating-cdrom"></a>CDROM üzerinde Sýkýþtýrýlmýþ Dosya Sistemi</h4></div></dt><dd><p>SquashFS ile (örneðin) çalýþan cd'lerde kullanýlacak büyük dosya sistemlerini de sýkýþtýrabilirsiniz. Bu amaçla SquashFS ile UnionFS birlikte kullanýlýr.</p><p><div class="itemizedlist"><ul type="disc"><li>Hedef sistemin Linux çekirdeðinde SquashFS'i aktif edin.</li><li>Sýkýþtýrýlmýþ bir kök dosya sistemi oluþturun.</li><li>Sýkýþtýrýlmýþ dosya sistemlerini baðlayabilmek için <tt>/etc/fstab</tt> dosyasýnda ve baþlangýç betiklerini düzenleyin.</li></ul></div></p><p>Çalýþan Linux sisteminizin dýþýnda bir kök dosya sistemi yarattýysanýz <b><tt>mksquashfs</tt></b> komutunu <b><tt>-e</tt></b> seçeneði ile kullanarak gerçek birer dosya sistemi olmayan /proc, /sys (2.5.x çekirdek sonrasý) ve /dev dizinlerini dahil etmeyin. Ayrýca <b><tt>mksquashfs</tt></b> ile yaratýlan dosya sistem görüntüsünün kendisini de çýkaracaðýnýz dizinler arasýna eklemeyi unutmayýn (bunlarý neden dahil etmediðimizi bildiðinizi düþünüyorum).</p></dd></div></dl></dd></div></dl><dl><div class="sect2"><dt><div> <h3 class="title"><a name="squashfs-howto-creatingandusing-readable"></a>Dosya Sistemini Yazýlabilir Yapmak</h3></div></dt><dd><p>Yukarýda da bahsettiðimiz gibi SquashFS'in ilginç bir kullanýmý da UnionFS dosya sistemi ile birlikte kullanýlmasýdýr. Bu sayede salt okunur dosya sistemi için kopyala-üzerine yaz (copy-on-write) kavramýnýn olanaklarý arttýrýlabilir. (UnionFS için <a href="http://www.filesystems.org/project-unionfs.html" target="_top">http://www.filesystems.org/project-unionfs.html</a> adresine bakabilirsiniz.) </p><p>Bir örnek olmasý için <tt>/home/user</tt> dizinini sýkýþtýrýlmýþ kullanmak ve bu dizinde deðiþiklik yapma veya yeni dosyalar yazma olanaðýnýzý da kaybetmek istemediðinizi kabul edelim.</p><p><tt>ro.fs</tt> sýkýþtýrýlmýþ dosya sistemini ve <tt>rw.fs</tt> dizinini oluþturun:<div class="screen" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="screen">bash# mksquashfs /home/user1 ro.fs
bash# mkdir /home/rw.fs</pre> </td></tr></table></div></p><p>Sýkýþtýrýlmýþ <tt>ro.fs</tt> dosya sistemini loopback aygýtý ile baðlayýn: <div class="screen" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="screen">bash# mount -t squashfs ro.fs /mnt -o loop</pre> </td></tr></table></div></p><p>Unionfs dosya sistemini baðlayýn, böylece <tt>/mnt</tt> ve <tt>/home/rw.fs</tt> dizinleri <tt>/home/user1</tt> altýnda birleþmiþ gibi olur.<div class="screen" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="screen">bash# cd /home
bash# mount -t unionfs -o dirs=rw.fs=rw:/mnt=ro unionfs user1</pre> </td></tr></table></div></p><p>Gördüðünüz gibi <tt>/home/user1</tt> dizininde yeni dosyalar oluþturabilirsiniz:<div class="screen" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="screen">bash# cd /home/user1
bash# touch file1
bash# ls</pre> </td></tr></table></div></p><p>Unionfs ve squashfs dosya sistemlerini çözün ve <tt>/home/user1</tt> dizininin içeriðini listeleyin:<div class="screen" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="screen">bash# cd ..
bash# umount /home/user1
bash# umount /mnt

bash# ls /home/user1
bash# ls /home/rw.fs</pre> </td></tr></table></div></p><p>Yeni oluþturulan <tt>file1</tt> dosyasýný <tt>/home/rw.fs</tt> içinde görebilirsiniz.</p><p>Kaarlý ve sýkýþtýrýlmýþ dosya sisteminize yeni dosyalar eklemek istediðinizde onlarý mevcut olanlara eklemeniz gerekir:<div class="screen" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="screen">bash# mksquashfs /home/rw.fs /home/ro.fs</pre> </td></tr></table></div></p><p>Artýk sýkýþtýrýlmýþ ev dizininizin baþlangýçta baðlanmasý için aþaðýdakileri sýrasýyla yapmalýsýnýz.</p><p>Squashfs ve unionfs modüllerinin baþlangýçta yüklenmesini saðlayýn.<div class="screen" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="screen">bash# echo squashfs &gt;&gt; /etc/modules
bash# echo unionfs &gt;&gt; /etc/modules</pre> </td></tr></table></div></p><p>Yazýlabilir dosyanýn sahibini user1 olarak deðiþtirin.<div class="screen" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="screen">chown user1 /home/rw.fs</pre> </td></tr></table></div></p><p><tt>/etc/fstab</tt> dosyasýna aþaðýdaki satýrlarý ekleyerek açýlýþta squashfs ve unionfs dosya sistemlerinin baðlanmasýný saðlayýn:<div class="screen" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="screen">...
/home/ro.fs  /mnt squashfs loop 0 0
unionfs /home/user1 unionfs dirs=/home/rw.fs=rw:/mnt=ro 0 0</pre> </td></tr></table></div></p></dd></div></dl></dd></div></dl><h1></h1><table width="100%" summary="Navigation header" cellpadding="1" cellspacing="0" border="0"><tr><td bgcolor="black" class="navoutline"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td bgcolor="white" class="navinline"><table width="100%" cellpadding="3" cellspacing="0" border="0"><tr><td width="40%" align="left"><a accesskey="p" href="../howto/squashfs-howto-tools.html">Önceki</a> </td><td width="20%" align="center"><a accesskey="u" href="../howto/squashfs-howto.html">Üst Ana Baþlýk</a></td><td width="40%" align="right"> <a accesskey="n" href="../howto/squashfs-howto-acknowledgements.html">Sonraki</a></td></tr><tr><td width="40%" align="left" valign="top">SquashFS Araçlarý </td><td width="20%" align="center"><a accesskey="h" href="../KiTAPLIK/index.html">Baþlangýç</a></td><td width="40%" align="right" valign="top"> Teþekkür</td></tr><tr><td colspan="3" align="center">
                  Bir <a href="http://www.belgeler.org/">Linux Kitaplýðý</a> Sayfasý
                </td></tr></table></td></tr></table></td></tr></table></body></html>
