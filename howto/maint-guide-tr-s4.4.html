<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-9"><meta name="date" content="2006-04-25T01:53:17+03:00"><title>rules dosyasý</title><link rel="icon" type="image/png" href="../images/belgeler-logo.png"><link rel="stylesheet" href="../belgeler.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V-special(derived from 1.49 for Turkish Linux Documentation WG by Nilgün Belma Bugüner - nilgun@superonline.com)"><link rel="home" href="../KiTAPLIK/index.html" title="Linux Kitaplýðý"><link rel="up" href="../howto/maint-guide-tr-s4.html" title="debian/ altýnda gerekli olanlar"><link rel="previous" href="../howto/maint-guide-tr-s4.3.html" title="changelog dosyasý"><link rel="next" href="../howto/maint-guide-tr-s5.html" title="debian/ altýndaki diðer dosyalar"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><table width="100%" summary="Navigation header" cellpadding="1" cellspacing="0" border="0"><tr><td bgcolor="black" class="navoutline"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td bgcolor="white" class="navinline"><table width="100%" cellpadding="3" cellspacing="0" border="0"><tr><th colspan="3" align="center">rules dosyasý</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="../howto/maint-guide-tr-s4.3.html">Önceki</a> </td><th width="60%" align="center">debian/ altýnda gerekli olanlar</th><td width="20%" align="right"> <a accesskey="n" href="../howto/maint-guide-tr-s5.html">Sonraki</a></td></tr></table></td></tr></table></td></tr></table><dl><div class="sect2"><dt><div> <h3 class="title"><a name="maint-guide-tr-s4.4"></a><tt>rules</tt> dosyasý</h3></div></dt><dd><p>
Artýk þimdi <b><tt>dpkg-buildpackage(1)</tt></b>'in asýl paketi oluþturmak için kullanacaðý gerçek kurallara bakmalýyýz. Bu dosya aslýnda bir diðer Makefile dosyasýdýr, fakat üst düzey kaynaktaki(ler)den farklýdýr. <tt>debian/</tt> içindeki diðer dosyalardan farklý olarak, bu çalýþtýrýlabilir olarak imlenmiþtir.
    </p><p>
Her <tt>rules</tt> dosyasý, diðer Makefile dosyalarý gibi, kaynaðýn nasýl iþleneceði ile ilgili çeþitli kurallar içerir. Her kural gerçeklenmesi gereken hedeflerden, dosya adlarýndan veya eylem adlarýndan (örn. <tt>build:</tt> veya <tt>install:</tt>) oluþur. Çalýþtýrmak istediðiniz kurallar komut satýrý argümanlarý olarak çaðrýlýr (<b><tt>./debian/rules build</tt></b> veya <b><tt>make -f rules install</tt></b> gibi). Hedef isminden sonra, baðýmlýlýðý, kuralýn baðlý olduðu program veya dosyanýn ismini kullanabilirsiniz. Bundan sonra, sekme ile ayrýlmýþ herhangi bir sayýda komut gelebilir. Yeni bir kural ilk sütunda yeni bir hedef bildirimi ile baþlar. Boþ satýrlar ve `#' (diyez) ile baþlayan satýrlar yorum satýrý olarak algýlanýr ve göz ardý edilir.
    </p><p>
Muhtemelen biraz kafanýz karýþtý, fakat <b><tt>dh_make</tt></b>'in oluþturduðu öntanýmlý <tt>rules</tt> dosyasýný incelerken hepsi netleþecektir. Ayrýca,  `<b><tt>info make</tt></b>'i daha fazla bilgi için okuyabilirsiniz.
    </p><p>
<b><tt>dh_make</tt></b>'in oluþturduðu <tt>rules</tt> dosyasý için bilinmesi gereken, onun sadece bir öneri oluþudur. Basit paketler için çalýþacak fakat karmaþýk olanlar için çalýþmayacaktýr, ihtiyaçlarýnýza uygun hale gelmesi için bu dosyadan çýkarma ve bu dosyaya ekleme yapmaktan korkmayýn. Deðiþtirmemeniz gereken tek þey kurallardýr, çünkü tüm araçlar <a class="ulink" href="http://www.debian.org/doc/debian-policy/" target="_top">Debian Politika Kýlavuzu</a>nda belirtildiði gibi bu isimleri kullanmaktadýr.
    </p><p>
<b><tt>dh_make</tt></b>'in bizim için oluþturduðu (yaklaþýk) bir <tt>rules</tt> dosyasý:
    </p><p>
<div class="screen" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td align="right" width="20" valign="top"><pre class="screen">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
</pre> </td><td width="*"><pre class="screen">
#!/usr/bin/make -f
# Sample debian/rules that uses debhelper. <i>debhelper'in kullandýðý örnek debian/rules</i>
# GNU copyright 1997 to 1999 by Joey Hess.

# Uncomment this to turn on verbose mode. <i>Ayrýntý kipi için # imini kaldýrýn</i>
#export DH_VERBOSE=1

# This is the debhelper compatibility version to use. <i>Kullanýlacak debhelper'in uyumluluk sürümü</i>
export DH_COMPAT=4

CFLAGS = -g
ifneq (,$(findstring noopt,$(DEB_BUILD_OPTIONS)))
CFLAGS += -O0
else
CFLAGS += -O2
endif

build: build-stamp
build-stamp:
       dh_testdir

       # Add here commands to compile the package. <i>Paketi derlerken kullanýlacak komutlarý buraya ekleyin.</i>
       $(MAKE)
       #docbook-to-man debian/gentoo.sgml &gt; gentoo.1

       touch build-stamp

clean:
       dh_testdir
       dh_testroot
       rm -f build-stamp

       # Add here commands to clean up after the build process. <i>Derleme bittikten sonra temizliði gerçekleþtirecek komutlarý buraya ekleyin.</i>
       -$(MAKE) clean

       dh_clean

install: build
       dh_testdir
       dh_testroot
       dh_clean -k
       dh_installdirs

       # Add here commands to install the package into debian/gentoo. <i>Paketi debian/gentoo'ya kuracak komutlarý buraya ekleyin.</i>
       $(MAKE) install DESTDIR=$(CURDIR)/debian/gentoo

# Build architecture-independent files here. <i>Derleme platformundan baðýmsýz dosyalar buraya.</i>
binary-indep: build install
# We have nothing to do by default. <i>Öntanýmlý olarak hiçbir þey yapmýyoruz.</i>

# Build architecture-dependent files here. <i>Derleme platformuna baðýmlý dosyalar buraya.</i>
binary-arch: build install
       dh_testdir
       dh_testroot
#      dh_installdebconf
       dh_installdocs
       dh_installexamples
       dh_installmenu
#      dh_installlogrotate
#      dh_installemacsen
#      dh_installpam
#      dh_installmime
#      dh_installinit
       dh_installcron
       dh_installman
       dh_installinfo
#      dh_undocumented
       dh_installchangelogs ChangeLog
       dh_link
       dh_strip
       dh_compress
       dh_fixperms
#      dh_makeshlibs
       dh_installdeb
#      dh_perl
       dh_shlibdeps
       dh_gencontrol
       dh_md5sums
       dh_builddeb

binary: binary-indep binary-arch
.PHONY: build clean binary-indep binary-arch binary install
</pre> </td></tr></table></div>
    </p><p>
Gerçek <tt>debian/rules</tt> dosyasýnda, satýrbaþlarýndaki boþluklar sekme karakterleridir.
    </p><p>
1. satýrdakine benzer satýrlara muhtemelen daha önce kabuk veya Perl betiklerinizden aþýnasýnýzdýr. Bu, iþletim sistemine bu dosyanýn <tt>/usr/bin/make</tt> ile yorumlanacaðýný söyler.
    </p><p>
6 ve 9. satýrlardaki DH_* deðiþkenlerinin anlamlarý kýsa açýklamalardan anlaþýlýyor olmalý. <tt>DH_COMPAT</tt> ile ilgili ayrýntýlý bilgi için, <b><tt>debhelper(1)</tt></b> kýlavuz sayfasýnýn "Debhelper uyumluluk seviyeleri" ("Debhelper compatibility levels") bölümünü okuyunuz.
    </p><p>
11'den 16'ya kadar olan satýrlar <tt>DEB_BUILD_OPTIONS</tt> parametreleri için destek iskeleti görevi görür, <a class="ulink" href="http://www.debian.org/doc/debian-policy/" target="_top">Debian Politika Kýlavuzu</a>nun 11.1 "Ýkilikler" ("Binaries") bölümünde anlatýlmýþtýr. Temelde, bu þeyler ikilik paketin hata ayýklama sembolleriyle beraber mi oluþturulacaðýný ve kurulum sýrasýnda bunlarýn ayýklanýp ayýklanmayacaðýný kontrol eder. Yine, bu sadece bir iskelettir, yapmanýz gerekenler için bir ipucudur. Üst düzey derleme sisteminin (upstream build system) hata ayýklama sembollerini nasýl dahil ettiðini, kurulumda bunlarý nasýl ayýrdýðýný ve bunu sizin nasýl gerçekleyeceðinizi incelemelisiniz.
    </p><p>
Genellikle <tt>CFLAGS</tt> deðiþkenini kullanarak <b><tt>gcc</tt></b>'ye <tt>-g</tt> seçeneðiyle derlemesini söyleyebilirsiniz - eðer bu sizin paketiniz için uygunsa; <tt>build</tt> kuralý içerisindeki <tt>$(MAKE)</tt> çaðrýsýnýn sonuna <tt>CFLAGS="$(CFLAGS)"</tt> ekleyerek deðiþkeni türetiniz (aþaðýya bakýnýz). Alternatif olarak, eðer paketiniz bir autoconf <tt>configure</tt> betiðini kullanýyorsa, yukarýdaki dizgeyi <tt>build</tt> kuralýndaki <tt>./configure</tt>'nin öncesine ekleyebilirsiniz.
    </p><p>
Hata ayýklama sembollerin ayýklama konusuna gelirsek, programlar genelde ayýklanmamýþ olarak kurulacak þekilde yapýlandýrýlmýþlardýr ve çoðunlukla bunu deðiþtirecek bir seçenek yoktur. Ne büyük þans ki, <tt>DEB_BUILD_OPTIONS=nostrip</tt> bayraðýný tespit edip sessizce çýkacak olan <b><tt>dh_strip(1)</tt></b> aracýna sahipsiniz.
    </p><p>
18'den 26'ya kadar olan satýrlar <tt>build</tt> kuralýný (ve onun çocuðu olan <tt>build-stamp</tt>) açýklar. Bu kural, <b><tt>make</tt></b>'i bu programý derlemek için kullanýlacak olan kendi Makefile dosyasý ile çalýþtýrýr. Eðer programýnýz ikilikleri derlemek için GNU yapýlandýrma araçlarýný kullanýyorsa, kesinlikle <tt>/usr/share/doc/autotools-dev/README.Debian.gz</tt> dosyasýný okuyunuz. Docbook'tan kýlavuz sayfasý üretme örneðine ileride <a href="../howto/maint-guide-tr-s5.8.html" class="xref" title="manpage.1.ex, manpage.sgml.ex"> manpage.1.ex, manpage.sgml.ex</a> bölümünde deðineceðiz.
    </p><p>
28-36 arasý satýrlarda belirtildiði gibi <tt>clean</tt> kuralý ile ilgili; paketin derlenmesi sonucu üretilen ve artýk ihtiyaç duyulmayan öðeleri temizler. Bu kural her zaman çalýþýr olmalýdýr (hatta kaynak aðacý temizlenmiþ olsa bile!), dolayýsiyle lütfen zorlayýcý parametreleri kullanýn (örn. <b><tt>rm</tt></b> için bu <tt>-f</tt>'dir) veya make'in geri dönüþ deðerlerini (hatalarý) ihmal etmesini komut isminden önce bir `-' kullanarak saðlayýn.
    </p><p>
Kurulum iþlemi, 38. satýrdaki <tt>install</tt> kuralý baþlar. Temel olarak programýn Makefile dosyasýndaki <tt>install</tt> kuralýný çalýþtýrýr, fakat kurulumu <tt>$(CURDIR)/debian/gentoo</tt> dizinine yapar - gentoo'nun Makefile dosyasýnda kurulumun kök dizini olarak <tt>$(DESTDIR)</tt> kullanmamýzýn sebebi budur.
    </p><p>
Açýklama satýrýndada belirtildiði gibi, 48. satýrdaki <tt>binary-indep</tt> kuralý, mimariden baðýmsýz paketleri derlemekte kullanýlýr. Böyle birþeye sahip olmadýðýmýzdan burada hiçbir þey yapmayacaðýz.
    </p><p>
Bir sonraki kuralda, 52 den 79'a kadar olan satýrlardaki <tt>binary-arch</tt> kuralý, paketin <a class="ulink" href="http://www.debian.org/doc/debian-policy/" target="_top">Debian Politika Kýlavuzu</a>na uyumluluðunu saðlamak için paket dosyalarýnýza çeþitli iþlemler uygulayan bazý <b><tt>debhelper</tt></b> yardýmcý uygulamalarýný çaðýrýr.
    </p><p>
Eðer paketiniz `Architecture: all' (Tüm mimarilerde derlenir) türü bir paketse, <tt>binary-arch</tt> kuralýný boþ býrakýp, paketinizi derlemek için gerekli tüm komutlarý <tt>binary-indep</tt> kuralýna eklemeniz gerekmektedir.
    </p><p>
<b><tt>debhelper</tt></b> araçlarýnýn isimleri <tt>dh_</tt> ile baþlar ve devamý aracýn ne yaptýðýnýn açýklamasýdýr. Ýsimleri yeterince açýklayýcý olmasýna raðmen bir miktar daha açýklama yapabiliriz:
    </p><p><div class="itemizedlist"><ul type="disc"><li><b><tt>dh_testdir(1)</tt></b> doðru dizinde olup olmadýðýnýzý kontrol eder (örn. kaynak aðacýnýn kökü).
    </li><li><b><tt>dh_testroot(1)</tt></b><tt>binary-arch</tt>, <tt>binary-indep</tt> ve <tt>clean</tt> kurallarý için gerekli root izinlerine sahip olup olmadýðýnýzý kontrol eder.
    </li><li><b><tt>dh_installman(1)</tt></b> kýlavuz sayfalarýný hedef dizindeki doðru yere yükleyecektir, sadece ona kaynak paketinin kök dizinine göre kýlavuz sayfalarýnýn yerlerini belirtmelisiniz.
    </li><li><b><tt>dh_strip(1)</tt></b> daha küçük hale getirmek için çalýþtýrýlabilir dosyalar ve kütüphanelerden hata ayýklama baþlýklarýný temizler.
    </li><li><b><tt>dh_compress(1)</tt></b> 4 kB'tan büyük belgeleri ve kýlavuz sayfalarýný <b><tt>gzip(1)</tt></b> ile sýkýþtýrýr.
    </li><li><b><tt>dh_installdeb(1)</tt></b> paketle ilgili dosyalarý (örn. bakýmcý betiklerini) <tt>debian/gentoo/DEBIAN</tt> dizinine kopyalar.
    </li><li><b><tt>dh_shlibdeps(1)</tt></b> kütüphanelerin ve çalýþan dosyalarýn paylaþýmlý kütüphane baðýmlýlýklarýný hesaplar.
    </li><li><b><tt>dh_gencontrol(1)</tt></b><tt>control</tt> dosyasýnýn düzgün ayarlanmýþ bir sürümünü <tt>debian/gentoo/DEBIAN</tt> altýna yükler.
    </li><li><b><tt>dh_md5sums(1)</tt></b> paketteki tüm dosyalar için MD5 saðlama toplamlarý üretir.
    </li></ul></div>
    </p><p>
Tüm bu <tt>dh_*</tt> betiklerinin ne yaptýklarý ve seçeneklerinin neler olduðu ile ilgili bilgi almak için kendi kýlavuz sayfalarýný okuyunuz. Baþka (muhtemelen çok faydalý) ve burada bahsedilememiþ <tt>dh_*</tt> betikleri de var. Eðer onlara ihtiyaç durarsanýz, <b><tt>debhelper(7)</tt></b> kýlavuz sayfasýný okuyunuz.
    </p><p>
<tt>binary-arch</tt> kýsmý gerçekten de ihtiyacýnýz olmayan özellikleri içeren satýrlarý çýkarmanýz gereken kýsýmdýr. gentoo için, cron, init, man, info ve örneklerle ilgili satýrlarý iptal edeceðim, çünkü gentoo bunlara ihtiyaç duymuyor. Ayrýca 68. satýrda, <tt>FIXES</tt>'i üstdüzey changelog dosyasýnýn adý olan <tt>ChangeLog</tt> ile deðiþtireceðim.
    </p><p>
Son iki satýr (ve burada bahsedilmeyen diðer satýrlarla beraber) bazý az veya çok gerekli þeylerdir, ki bunlarý <b><tt>make(1)</tt></b> kýlavuz sayfasýnda ve <a class="ulink" href="http://www.debian.org/doc/debian-policy/" target="_top">Debian Politika Kýlavuzu</a>nda okuyabilirsiniz. Þu an için, bilmek o kadar da önemli deðil.
      </p></dd></div></dl><h1></h1><table width="100%" summary="Navigation header" cellpadding="1" cellspacing="0" border="0"><tr><td bgcolor="black" class="navoutline"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td bgcolor="white" class="navinline"><table width="100%" cellpadding="3" cellspacing="0" border="0"><tr><td width="40%" align="left"><a accesskey="p" href="../howto/maint-guide-tr-s4.3.html">Önceki</a> </td><td width="20%" align="center"><a accesskey="u" href="../howto/maint-guide-tr-s4.html">Üst Ana Baþlýk</a></td><td width="40%" align="right"> <a accesskey="n" href="../howto/maint-guide-tr-s5.html">Sonraki</a></td></tr><tr><td width="40%" align="left" valign="top">changelog dosyasý </td><td width="20%" align="center"><a accesskey="h" href="../KiTAPLIK/index.html">Baþlangýç</a></td><td width="40%" align="right" valign="top"> debian/ altýndaki diðer dosyalar</td></tr><tr><td colspan="3" align="center">
                  Bir <a href="http://www.belgeler.org/">Linux Kitaplýðý</a> Sayfasý
                </td></tr></table></td></tr></table></td></tr></table></body></html>
