<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-9"><meta name="date" content="2006-04-25T01:45:23+03:00"><title>Hýzlý baþlangýç</title><link rel="icon" type="image/png" href="../images/belgeler-logo.png"><link rel="stylesheet" href="../belgeler.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V-special(derived from 1.49 for Turkish Linux Documentation WG by Nilgün Belma Bugüner - nilgun@superonline.com)"><link rel="home" href="../KiTAPLIK/index.html" title="Linux Kitaplýðý"><link rel="up" href="../howto/assembly-howto.html" title="Linux Makina Dili NASIL"><link rel="previous" href="../howto/assembly-howto-s-call.html" title="Çaðrý Uzlaþýmlarý"><link rel="next" href="../howto/assembly-howto-s-res.html" title="Özkaynaklar"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><table width="100%" summary="Navigation header" cellpadding="1" cellspacing="0" border="0"><tr><td bgcolor="black" class="navoutline"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td bgcolor="white" class="navinline"><table width="100%" cellpadding="3" cellspacing="0" border="0"><tr><th colspan="3" align="center">Hýzlý baþlangýç</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="../howto/assembly-howto-s-call.html">Önceki</a> </td><th width="60%" align="center">Linux Makina Dili NASIL</th><td width="20%" align="right"> <a accesskey="n" href="../howto/assembly-howto-s-res.html">Sonraki</a></td></tr></table></td></tr></table></td></tr></table><dl><div class="sect1"><dt><div> <h2 class="title" style="clear: both"><a name="assembly-howto-s-quick"></a>Hýzlý baþlangýç</h2></div></dt><dd><dl><div class="sect2"><dt><div> <h3 class="title"><a name="id1"></a>Giriþ</h3></div></dt><dd><p>
Son olarak, eðer hala bu çýlgýnca fikri denemek ve sembolik makina kodu yazmak istiyorsanýz (eðer bu kýsma ulaþtýysanýz gerçekten de bir sembolik makina hayranýsýnýzdýr), baþlangýç için gerekenleri bu kýsýmda bulacaksýnýz.
</p><p>
Daha önce de okuduðunuz gibi, Linux için deðiþik þekillerde yazabilirsiniz; size <i>doðrudan</i> sistem çaðrýlarýný nasýl yapacaðýnýzý göstereceðim, çünkü bu çekirdek servislerini çaðýrmanýn en hýzlý yoludur; kodumuz hiç bir kütüphaneye baðlý deðildir, ELF yorumlayýcýsýný kullanmayýnýz, çünkü çekirdek ile doðrudan iletiþim kurar.
</p><p>
Ayný kodu <b><tt>nasm</tt></b> ve <b><tt>gas</tt></b> için göstereceðim ve böylelikle Intel ve AT&amp;T söz dizimini de göstermiþ olacaðým.
</p><p>
Ayný zamanda <a class="ulink" href="http://linuxassembly.org/intro.html" target="_top">Unix bembolik makne dili ile programlamaya giriþ kýlavuzu</a>nu okumak isteyebilirsiniz; UNIX benzeri iþletim sistemleri için örnek kodlar da içermektedir.
</p><dl><div class="sect3"><dt><div> <h4 class="title"><a name="id11"></a>Ýhtiyacýnýz olan araçlar</h4></div></dt><dd><p>
Herþeyden önce bir çeviriciye (derleyici) ihtiyacýnýz vardýr - <b><tt>nasm</tt></b> veya <b><tt>gas</tt></b>
</p><p>
Ýkinci olarak, bir ilintileyiciye (linker) ihtiyacýnýz vardýr - <b><tt>ld</tt></b>, çünkü çeviriciler sadece nesne kodunu üretmektedir. Hemen her daðýtým gas ve ld'yi binutils içerisinde sunmaktadýr.
</p><p>
nasm'a gelince, Linux için paketleri ve belgeleri <a class="link" href="../howto/assembly-howto-s-assem.html#assembly-howto-p-nasm-where" title="NASM'ý nereden bulurum">nasm sayfasýndan</a> indirip kurmanýz gerekebilir, pekçok daðýtýmýn (Stampede, Debian, SuSe, Mandrake) nasm'ý kendi sürümleri içerisinde barýndýrdýklarýný unutmayýn, önce bir kontrol edin.
</p><p>
Eðer daha derine inecekseniz, iþletim sisteminizin baþlýk dosyalarýný ve mümkünse çekirdek kaynak paketini edinmelisiniz.
</p></dd></div></dl></dd></div></dl><dl><div class="sect2"><dt><div> <h3 class="title"><a name="assembly-howto-hello"></a>Merhaba Dünyalý <tt>:-)</tt></h3></div></dt><dd><dl><div class="sect3"><dt><div> <h4 class="title"><a name="id12"></a>Yerleþim</h4></div></dt><dd><p>
Linux, 32 bitliktir, korumalý kipte çalýþýr, düz bellek modeline sahiptir ve ikilikler için ELF biçimini kullanýr.
</p><p>
Bir program bölümlere ayrýlabilir: kodunuz için <tt>.text</tt> kýsný (salt-okunur), verileriniz için <tt>.data</tt> kýsmý (oku-yaz), ilklendirilmemiþ veriler için <tt>.bss</tt> kýsmý (oku-yaz); aslýnda bir kaç tane daha, kullanýcý tanýmlý bölüm yanýnda, standart bölüm olabilir, fakat onlarýn kullanýlacaklarý durumlar çok nadir olmaktadýr ve bizim ilgi alanýmýz dýþýndalar. Bir program en azýndan <tt>.text</tt> kýsmýna sahip olmalýdýr.
</p><p>
Þimdi ilk programýmýzý yazacaðýz.
</p></dd></div></dl><dl><div class="sect3"><dt><div> <h4 class="title"><a name="id22"></a>NASM (hello.asm)</h4></div></dt><dd><p>
<div class="programlisting" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="programlisting">
section .text                           ;bölüm bildirimi

                           ;giriþ noktasýný ELF ilintileyiciye veya yükleyiciye
    global _start          ;göndermeliyiz (export). Giriþ noktasýný uzlaþýmsal
                           ;olarak _start ile belirtiriz. Öntanýmlý durumu
                           ;deðiþtirmek için: ld -e foo kullanýn.

_start:

;dizgemizi stdout'a yazar

        mov     edx,len    ;üçüncü argüman: ileti uzunluðu
        mov     ecx,msg    ;ikinci argüman: yazýlacak iletinin göstericisi
        mov     ebx,1      ;ilk argüman: dosya tutucu (stdout)
        mov     eax,4      ;sistem çaðrýsý numarasý (sys_write)
        int     0x80       ;çekirdeði çaðýr

;ve çýk

        mov     ebx,0      ;ilk sistem çaðrýsý argümaný: çýkýþ kodu
        mov     eax,1      ;sistem çaðrý numarasý (sys_exit)
        int     0x80       ;çekirdeði çaðýr

section .data              ;bölüm bildirimi

        msg     db      "Hello, world!",0xa     ;sevgili dizgemiz
        len     equ     $ - msg                 ;sevgili dizgemizin boyu
</pre> </td></tr></table></div>
</p></dd></div></dl><dl><div class="sect3"><dt><div> <h4 class="title"><a name="id32"></a>GAS (hello.S)</h4></div></dt><dd><p>
<div class="programlisting" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="programlisting">
.text                                   # bölüm bildirimi

                           ;giriþ noktasýný ELF ilintileyiciye veya yükleyiciye
    global _start          ;göndermeliyiz (export). Giriþ noktasýný uzlaþýmsal
                           ;olarak _start ile belirtiriz. Öntanýmlý durumu
                           ;deðiþtirmek için: ld -e foo kullanýn.

_start:

# dizgemizi stdout'a yazar

        movl    $len,%edx     # üçüncü argüman: ileti uzunluðu
        movl    $msg,%ecx     # ikinci argüman: yazýlacak iletinin göstericisi
        movl    $1,%ebx       # ilk argüman: dosya tutucu (stdout)
        movl    $4,%eax       # sistem çaðrý numarasý
        int     $0x80         # çekirdeði çaðýr

# ve çýk

        movl    $0,%ebx       # ilk sistem çaðrýsý argümaný: çýkýþ kodu
        movl    $1,%eax       # sistem çaðrý numarasý (sys_exit)
        int     $0x80         # çekirdeði çaðýr

.data                         # bölüm bildirimi

        msg:
                .ascii  "Hello, world!\n"       # sevgili dizgemiz
                len = . - msg                   # sevgili dizgemizin boyu
</pre> </td></tr></table></div>
</p></dd></div></dl></dd></div></dl><dl><div class="sect2"><dt><div> <h3 class="title"><a name="assembly-howto-build"></a>Çaliþtýrýlabilir bir kod üretmek</h3></div></dt><dd><dl><div class="sect3"><dt><div> <h4 class="title"><a name="id13"></a>Nesne kodu üretimi</h4></div></dt><dd><p>
Çalýþtýrýlabilir bir kod elde etmenin ilk adýmý nesne dosyasýný kaynaktan derlemek (veya çevirmek)tir:
</p><p>
Nasm örneði için:
</p><p>
<div class="screen" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="screen">$ <b><tt>nasm -f elf hello.asm</tt></b>
</pre> </td></tr></table></div>
</p><p>
gas örneði için
</p><p>
<div class="screen" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="screen">$ <b><tt>as -o hello.o hello.S</tt></b>
</pre> </td></tr></table></div>
</p><p>
Bu <tt>hello.o</tt> nesne dosyasýný oluþturur.
</p></dd></div></dl><dl><div class="sect3"><dt><div> <h4 class="title"><a name="id23"></a>Çalýþtýrýlabilir üretmek</h4></div></dt><dd><p>
Ýkinci adým ilintileyiciyi çaðýrarak nesne dosyasýnýn kendisinden çalýþtýrýlabilir bir dosya üretmektir:
</p><p>
<div class="screen" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="screen">$ <b><tt>ld -s -o hello hello.o</tt></b>
</pre> </td></tr></table></div>
</p><p>
Sonuç olarak bu <tt>hello</tt> çalýþtýrýlabilir dosyasýný üretecektir.
   </p><p>
Hey, çalýþtýrmayý deneyin... Çalýþtý mý? Ýþte bu. Oldukça basit.
</p></dd></div></dl></dd></div></dl><dl><div class="sect2"><dt><div> <h3 class="title"><a name="id4"></a>MIPS Örneði</h3></div></dt><dd><p>
Gerçek dünyada x86 sülalesi dýþýnda da bir evren var. Aþaðýda Spencer Parkin tarafýndan sunulan ve MIPS iþlemciler için yazýlmýþ bir örnek vardýr. Buraya kadar gelmiþken <a class="ulink" href="http://www.cuillin.demon.co.uk/nazz/trivia/hw/hw_assembler.html" target="_top">http://www.cuillin.demon.co.uk/nazz/trivia/hw/hw_assembler.html</a> adresindeki Bir Grup Sembolik Makina Dili ile Yazýlmýþ Merhaba Dünya Programýna bakabilirsiniz.
   </p><p>
<div class="programlisting" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="programlisting">
# hello.S       by Spencer T. Parkin

# Bu benim ilk MIPS-RISC sembolik makina dili programým!
# Derlemek için:
# &gt; gcc -o hello hello.S -non_shared

# Bu program PlayStation2 MIPS R5900 (EE Çekirdek)
# üzerinde hatasýz ve uyarýsýz derlenir.
# EE Duygu Makinasý (Emotion Engine) anlamýna gelir

# -non_shared seçeneði gcc'ye
# yeniden tahsis edilebilir kod ile ilgilenmediðimizi söyler.
# Eðer isteseydik, PIC-ABI çaðrým kurallarýný
# ve diðer protokolleri kullanmalýydýk

#include &lt;asm/regdef.h&gt;         // Anaþýlabilir yazmaç adlarý için
#include &lt;asm/unistd.h&gt;         // Sistem servisleri için

        .rdata                  # yalnýz okunabilir veri bölümüne baþlangýç
        align          2        # belleðin yapým þeklinden dolayý böyle

hello:  .asciz  "Hello, world!\n"  # Null ile sonlanmýþ bir karakter dizisi
        .align  4               # belleðin yapým þeklinden dolayý
length: .word   .- hello        # length = IC - (hello-addr)

        .text                   # kod bölümü baþlangýcý
        .globl  main            # gcc/ld baðlamasýndan dolayý
        .ent    main            # gdp hata ayýklama bilgisi

main:                           # gcc'ye bir -non_shared alaný sunmalýyýz
                                # ya da aþaðýdaki üç satýr etkin olmalý
#       .set    noreorder       # yeniden komut sýralamasýný kapat
#       .cpload t9              # PIC ABI zýrvasý
#       .set    reorder         # yeniden komut sýralamasý aktif

        move    a0,$0           # dosya tanýmlayýcýsý standart çýktýyý göstersin
        la      a1,hello        # karakter dizisi adresini yükle
        lw      a2,length       # karakter dizisi boyunu yükle
        li      v0,__NR_write   # sistem yazma servislerini belirt
        syscall                 # çekirdeði çaðýr (karakter dizisini yaz)
        li      v0,0            # geri dönüþ kodunu yükle
        j       ra              # çaðýrana dönüþ
        .end    main            # dgb için hata ayýklama bilgisi

# hepsi bu kadar millet!
</pre> </td></tr></table></div></p></dd></div></dl></dd></div></dl><h1></h1><table width="100%" summary="Navigation header" cellpadding="1" cellspacing="0" border="0"><tr><td bgcolor="black" class="navoutline"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td bgcolor="white" class="navinline"><table width="100%" cellpadding="3" cellspacing="0" border="0"><tr><td width="40%" align="left"><a accesskey="p" href="../howto/assembly-howto-s-call.html">Önceki</a> </td><td width="20%" align="center"><a accesskey="u" href="../howto/assembly-howto.html">Üst Ana Baþlýk</a></td><td width="40%" align="right"> <a accesskey="n" href="../howto/assembly-howto-s-res.html">Sonraki</a></td></tr><tr><td width="40%" align="left" valign="top">Çaðrý Uzlaþýmlarý </td><td width="20%" align="center"><a accesskey="h" href="../KiTAPLIK/index.html">Baþlangýç</a></td><td width="40%" align="right" valign="top"> Özkaynaklar</td></tr><tr><td colspan="3" align="center">
                  Bir <a href="http://www.belgeler.org/">Linux Kitaplýðý</a> Sayfasý
                </td></tr></table></td></tr></table></td></tr></table></body></html>
