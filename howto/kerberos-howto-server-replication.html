<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-9"><meta name="date" content="2008-10-06T10:10:12+03:00"><title>Kerberos Sunucusunun Birebir Kopyalanmasý</title><link rel="icon" type="image/png" href="../images/belgeler-logo.png"><link rel="stylesheet" href="../belgeler.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V-special(derived from 1.49 for Turkish Linux Documentation WG by Nilgün Belma Bugüner - nilgun@superonline.com)"><link rel="home" href="../KiTAPLIK/index.html" title="Linux Kitaplýðý"><link rel="up" href="../howto/kerberos-howto.html" title="Kerberos Altyapýsý NASIL"><link rel="previous" href="../howto/kerberos-howto-time-sync.html" title="Eþzamanlama"><link rel="next" href="../howto/kerberos-howto-client-configure.html" title="Ýstemci Yapýlandýrmasý"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><table width="100%" summary="Navigation header" cellpadding="1" cellspacing="0" border="0"><tr><td bgcolor="black" class="navoutline"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td bgcolor="white" class="navinline"><table width="100%" cellpadding="3" cellspacing="0" border="0"><tr><th colspan="3" align="center">Kerberos Sunucusunun Birebir Kopyalanmasý</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="../howto/kerberos-howto-time-sync.html">Önceki</a> </td><th width="60%" align="center">Kerberos Altyapýsý NASIL</th><td width="20%" align="right"> <a accesskey="n" href="../howto/kerberos-howto-client-configure.html">Sonraki</a></td></tr></table></td></tr></table></td></tr></table><dl><div class="sect1"><dt><div> <h2 class="title" style="clear: both"><a name="kerberos-howto-server-replication"></a>Kerberos Sunucusunun Birebir Kopyalanmasý</h2></div></dt><dd><dl><div class="sect2"><dt><div> <h3 class="title"><a name="kerberos-howto-replication"></a>Birebir Kopyalamanýn Tanýmý</h3></div></dt><dd><p>
Kerberos ana/yardýmcý birebir kopyalama kümelemesine izin verecek þekilde tasarlanmýþtýr. Bir kerberos kümelemesinde istenilen sayýda düðüm olabilmesine raðmen en az iki adet olmasý önerilmektedir. Birincil sunucu olarak bir ana sunucu ve onu yedeklemek için en az bir yardýmcý sunucu bulunmalýdýr. Ana ve yardýmcý sunucular birincil ve ikincil sunucular olarak düþünülebilirler.
</p><p>
Kerberos hesaplar ve kurallar ile ilgili tüm verilerini bir uygulama veritabanýnda tutar. Kerberos yazýlýmý bu verileri diðer sunuculara yedekleyecek veya kopyalayacak yazýlýmlarý da içerir.
</p><p>
Kerberos istemci uygulamalarý eðer birincil sunucuya ulaþýlamaz ise ikincil sunucudan kimlik denetimi yapmayý deneyecek þekilde tasarlanmýþtýr. Bu yüzden bir sistem arýzasý durumunda Kerberos kimlik denetimi servisinin yedekleme sunucusundan yapýlmasý için ilave bir çaba harcamanýza gerek yoktur. Kerberos'un yönetimsel özellikleri otomatik hata telafisini içermez.
</p><p>
Birincil sunucunuzun eriþilemez olmasý durumunda kadmind eriþilemez olacaktýr. Bu nedenle sunucu tamir edilene veya deðiþtirilene kadar yönetimsel iþlevler çalýþmayacaktýr. Özellikle yetkili kullanýcý yönetimi, anahtar üretimi ve anahtar deðiþimi birincil sunucu çalýþmadýðý sürece yapýlamayacaktýr.
</p></dd></div></dl><dl><div class="sect2"><dt><div> <h3 class="title"><a name="kerberos-howto-implementation"></a>Gerçekleme</h3></div></dt><dd><p>
Sunucunun birebir kopyalamasý kprop komutu ile yapýlýr. kprop komutu birincil ana KDC üzerinde çalýþtýrýlmalýdýr. Zamanlandýrýlmýþ bir görev olarak çalýþtýrýlmalý ve esas veritabanýnýn tüm sunucularda eþzamanlý olmasý saðlanmalýdýr.
</p><p>
Sunucuyu birebir kopyalamanýn ilk adýmý, kpropd için ACL'ler hazýrlamaktýr. kpropd acl dosya adlarý öntanýmlý olarak <tt>/var/Kerberos/krb5kdc/kpropd.acl</tt> dosyasýnda bulunur. Bizim örneðimizde içerik aþaðýdaki gibi olacaktýr:
</p><p>
<div class="screen" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="screen">host/kerberos1.gnud.ie@GNUD.IE
host/kerberos2.gnud.ie@GNUD.IE
</pre> </td></tr></table></div>
</p><p>
<tt>kpropd.acl</tt> dosyasý sadece yardýmcý Kerberos sunucularýnda bulunmalýdýr. Fedora GNU/Linux'da, <tt>/var/Kerberos/krb5kdc/kpropd.acl</tt> dosyasýnýn bulunduðu bir Kerberos sunucusunda kadmin çalýþmayacaktýr.
</p><p>
Sýradaki adýmda ana ve yardýmcý Kerberos sunucularýnýz için konak anahtarlarýný yaratmanýz gerekir:
</p><p>
<div class="screen" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="screen">{Kerberos1}bash# <b><tt>kadmin.local</tt></b>
{Kerberos1}kadmin.local:  <b><tt>addprinc -randkey host/kerberos1.gnud.ie</tt></b>
{Kerberos1}kadmin.local:  <b><tt>addprinc -randkey host/kerberos2.gnud.ie</tt></b>
</pre> </td></tr></table></div>
</p><p>
Þimdi bu anahtarlarýn <tt>keytab</tt> dosyasýndan çýkartýlmasý gereklidir. <tt>keytab</tt> dosyasý kriptografik anahtarlarý içerir ve KDC ile kimlik kanýtlamasý yapmak için kritik önem taþýr. Anahtarlarýn çýkartýlmasý ktadd alt komutu ile yapýlýr:
</p><p>
<div class="screen" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="screen">{Kerberos1}kadmin.local:  <b><tt>ktadd host/kerberos1.gnud.ie</tt></b>
{Kerberos1}kadmin.local:  <b><tt>ktadd host/kerberos2.gnud.ie</tt></b>
</pre> </td></tr></table></div>
</p><p>
Son olarak, kimlik kanýtlamasýnda kullanabilmeleri için <tt>keytab</tt> dosyasýný yardýmcý sunuculara kopyalamanýz gereklidir.
</p><p>
<div class="screen" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="screen">{Kerberos2}bash# <b><tt>scp root@kerberos1.gnud.ie:/etc/krb5.keytab /etc</tt></b>
</pre> </td></tr></table></div>
</p><p>
Aþaðýda her onbeþ dakikada bir Kerberos sunucusunda çalýþacak ve esas veritabanýný eþleyecek crontab girdisi bulunmaktadýr:
<div class="screen" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="screen">15 * * * * /usr/local/bin/krb5prop.sh
</pre> </td></tr></table></div>
</p><p>
<tt>krb5prop.sh</tt> betiðinin içeriði þöyledir:
<div class="screen" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="screen">#!/bin/sh

/usr/Kerberos/sbin/kdb5_util dump /var/Kerberos/krb5kdc/slave_datatrans

/usr/Kerberos/sbin/kprop -f /var/Kerberos/krb5kdc/slave_datatrans kerberos2.gnud.ie &gt; /dev/null
</pre> </td></tr></table></div>
</p><p>
Bu komutu ilk olarak elle çalýþtýrdýðýnýzda aþaðýdakine benzer bir çýktý almalýsýnýz:
</p><p>
<div class="screen" align="right"><table width="95%" cellpadding="5" cellspacing="1" border="0" class="preoutline"><tr class="preinline"><td> <pre class="screen">
{Kerberos1}bash# <b><tt>/usr/Kerberos/sbin/kdb5_util dump /var/Kerberos/krb5kdc/slave_datatrans</tt></b>
{Kerberos1}bash# <b><tt>/usr/Kerberos/sbin/kprop -d -f /var/Kerberos/krb5kdc/slave_datatrans</tt></b> kerberos2.gnud.ie
3234 bytes sent.
Database propagation to kerberos2.gnud.ie: SUCCEEDED
{Kerberos1}bash#
</pre> </td></tr></table></div>
</p><p>
Yardýmcý sunucu artýk esas veritabanýný ana sunucudan eþleyecektir.
</p></dd></div></dl><dl><div class="sect2"><dt><div> <h3 class="title"><a name="kerberos-howto-maintain"></a>Bakým</h3></div></dt><dd><p>
Bu cron betikleri ile esas yayýlýmýn yeterince otomatikleþmiþ olmasý ve ilave bakýma ihtiyaç duymamasý gerekir. Birincil KDC'nin çalýþmamasý durumunda arýza uzun sürmedikçe insan müdahalesine gerek olmaz.
</p></dd></div></dl></dd></div></dl><h1></h1><table width="100%" summary="Navigation header" cellpadding="1" cellspacing="0" border="0"><tr><td bgcolor="black" class="navoutline"><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td bgcolor="white" class="navinline"><table width="100%" cellpadding="3" cellspacing="0" border="0"><tr><td width="40%" align="left"><a accesskey="p" href="../howto/kerberos-howto-time-sync.html">Önceki</a> </td><td width="20%" align="center"><a accesskey="u" href="../howto/kerberos-howto.html">Üst Ana Baþlýk</a></td><td width="40%" align="right"> <a accesskey="n" href="../howto/kerberos-howto-client-configure.html">Sonraki</a></td></tr><tr><td width="40%" align="left" valign="top">Eþzamanlama </td><td width="20%" align="center"><a accesskey="h" href="../KiTAPLIK/index.html">Baþlangýç</a></td><td width="40%" align="right" valign="top"> Ýstemci Yapýlandýrmasý</td></tr><tr><td colspan="3" align="center">
                  Bir <a href="http://www.belgeler.org/">Linux Kitaplýðý</a> Sayfasý
                </td></tr></table></td></tr></table></td></tr></table></body></html>
